See the design document for more details.